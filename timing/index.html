<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <meta name="author" content="Rafael de Oliveira Calcada">
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Timing Diagrams - Steel Core Documentation</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../css/theme.css" />
  <link rel="stylesheet" href="../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" />
  <link href="../extra.css" rel="stylesheet" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "Timing Diagrams";
    var mkdocs_page_input_path = "timing.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> Steel Core Documentation</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="..">Overview</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../getting/">Getting Started</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../uarch/">Microarchitecture</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../config/">Configuration</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../steelio/">Input and Output Signals</a>
                    </li>
                </ul>
                <ul class="current">
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">Timing Diagrams</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#instruction-fetch">Instruction fetch</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#data-fetch">Data fetch</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#data-writing">Data writing</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#interrupt-request">Interrupt request</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#time-csr-update">time CSR update</a>
    </li>
    </ul>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../traps/">Exceptions and Interrupts</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../details/">Implementation Details</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">Steel Core Documentation</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
    
    <li>Timing Diagrams</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/rafaelcalcada/steel-core/edit/master/docs/timing.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="timing-diagrams">Timing Diagrams</h1>
<h2 id="instruction-fetch">Instruction fetch</h2>
<p>To fetch an instruction, the core places the instruction address on the <code>I_ADDR</code> bus. The memory must place the instruction on the <code>INSTR</code> bus at the next clock rising edge. The figure below shows the timing diagram of this process. In the figure, <strong>mem[addrX]</strong> denotes the instruction stored at the memory position <strong>addrX</strong>.</p>
<p><img alt="Instruction fetch timing diagram" src="../images/ifetch_wave.png" /></p>
<h2 id="data-fetch">Data fetch</h2>
<p>To fetch data from memory, the core puts the data address on the <code>D_ADDR</code> bus. The memory must place the data on the <code>DATA_IN</code> bus at the next clock rising edge. The figure below shows the timing diagram of this process. In the figure, <strong>mem[addrX]</strong> denotes the data stored at the memory position <strong>addrX</strong>.</p>
<p><img alt="Data fetch timing diagram" src="../images/dfetch_wave.png" /></p>
<h2 id="data-writing">Data writing</h2>
<p>To write data to memory, the core drives <code>D_ADDR</code>, <code>DATA_OUT</code>, <code>WR_REQ</code> and <code>WR_MASK</code> signals as follows:</p>
<ul>
<li><code>D_ADDR</code> receives the address of the memory position where the data must be written;</li>
<li><code>DATA_OUT</code> receives the data to be written;</li>
<li><code>WR_REQ</code> is set high;</li>
<li><code>WR_MASK</code> receives a byte-write enable mask that indicates which bytes of <code>DATA_OUT</code> must be written.</li>
</ul>
<p>The memory must perform the write operation at the next clock rising edge. The core can request to write bytes, halfwords and words.</p>
<p>The figure below shows the process of writing data to memory. <code>DATA_IN</code> is not used in the process and appears only to show the memory contents after writing. The figure shows five clock cycles, in which the core requests to write in the second, third and fourth cycles. In the second clock cycle, the core requests to write the word <strong>0x12345678</strong> at the address <strong>addr2</strong>. In the third, requests to write the halfword <strong>0xABCD</strong> at the upper half of <strong>addr2</strong>, and in the fourth requests to write the byte <strong>0xEF</strong> at the second least significant byte of <strong>addr2</strong>. The content of <strong>addr2</strong> after each of these operations appears on the <code>DATA_IN</code> bus and are highlighted in blue.</p>
<p><img alt="Data writing timing diagram" src="../images/dwrite_wave.png" /></p>
<h2 id="interrupt-request">Interrupt request</h2>
<p>An external device (or an interrupt controller managing several devices) can request interrupts by setting high the appropriate IRQ signal, which is <code>E_IRQ</code> for external interrupts, <code>T_IRQ</code> for timer interrupts and <code>S_IRQ</code> for software interrupts. The IRQ signal of the requested interrupt must be set high for one clock cycle and set low for the next.</p>
<p>The figure below shows the timing diagram of the interrupt request process. Since the process is the same for all types of interrupt, <strong>X_IRQ</strong> is used to denote <code>E_IRQ</code>, <code>T_IRQ</code> or <code>S_IRQ</code>. <strong>TRAP_ADDR</strong> denotes the address of the trap handler first instruction.</p>
<p align="center">
<img src="../images/irq_wave.png" width="80%"></img>
</p>

<h2 id="time-csr-update"><em>time</em> CSR update</h2>
<p>When connected to a real-time counter, the core updates the <code>time</code> CSR with the value placed on <code>REAL_TIME</code> at each clock rising edge, as shown in the figure below. <strong>timeX</strong> denotes arbitrary time values.</p>
<p align="center">
<img src="../images/timeup_wave.png" width="80%"></img>
</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../traps/" class="btn btn-neutral float-right" title="Exceptions and Interrupts">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../steelio/" class="btn btn-neutral" title="Input and Output Signals"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/rafaelcalcada/steel-core/" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../steelio/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../traps/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="../extra.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
